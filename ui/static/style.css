/* ====== Theme ====== */
:root{
  --bg:#f3f5f8;
  --panel:#ffffff;
  --line:#e7ebf2;
  --text:#0f172a;
  --muted:#6b7280;
  --brand:#16a34a;
  --brand-2:#22c55e;
  --accent:#0ea5e9;
  --radius:16px;
  --shadow:0 10px 24px rgba(15,23,42,.06);
}
@media (prefers-color-scheme: dark){
  :root{
    --bg:#0b0e14; --panel:#10141d; --line:#1f2735; --text:#e5e7eb; --muted:#9aa3af;
    --shadow:0 10px 24px rgba(0,0,0,.35);
  }
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0; background:var(--bg); color:var(--text); font:15px/1.55 ui-sans-serif,system-ui,Segoe UI,Roboto,Arial}

/* ====== Layout ====== */
.app{display:grid; grid-template-columns: 250px 1fr; min-height:100dvh}
.sidebar{
  background:var(--panel); border-right:1px solid var(--line); padding:18px; position:sticky; top:0; height:100dvh;
}
.main{padding:18px 22px}

/* ====== Sidebar ====== */
.brand{display:flex; align-items:center; gap:12px; margin-bottom:18px}
.brand__logo{inline-size:40px; block-size:40px; display:grid; place-items:center; background:rgba(34,197,94,.1); border-radius:10px}
.brand__title{font-weight:800} .brand__subtitle{color:var(--muted); font-size:.85rem}

.nav{display:flex; flex-direction:column; gap:8px}
.nav__item{
  display:flex; align-items:center; gap:10px;
  padding:.65rem .75rem; border-radius:12px; color:var(--text); text-decoration:none;
}
.nav__item:hover{background:rgba(15,23,42,.04)}
.nav__item.is-active{background:rgba(34,197,94,.15); color:#065f46}
.nav__icon{font-size:1.05rem}

/* ====== Topbar ====== */
.topbar{display:flex; align-items:center; justify-content:space-between; gap:16px; margin-bottom:16px}
.search{display:flex; align-items:center; gap:8px; background:var(--panel); border:1px solid var(--line); border-radius:999px; padding:.5rem .75rem; min-width:300px; box-shadow:var(--shadow)}
.search__icon{color:var(--muted)}
.search__input{border:0; outline:0; background:transparent; color:inherit; width:100%}
.topbar__right{display:flex; align-items:center; gap:10px}
.chip{border:1px solid var(--line); background:var(--panel); border-radius:999px; padding:.45rem .65rem; cursor:pointer}
.avatar{inline-size:34px; block-size:34px; border-radius:50%; background:linear-gradient(135deg,#94a3b8,#cbd5e1)}

/* ====== KPI ====== */
.kpi-row{display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap:14px; margin-bottom:14px}
.kpi{background:var(--panel); border:1px solid var(--line); border-radius:var(--radius); padding:14px 16px; box-shadow:var(--shadow); display:grid; grid-template-columns:auto 1fr; column-gap:12px; align-items:center}
.kpi__icon{inline-size:32px; block-size:32px; display:grid; place-items:center; background:rgba(34,197,94,.15); color:#047857; border-radius:10px}
.kpi__label{color:var(--muted); font-weight:600}
.kpi__value{font-weight:800; font-size:1.2rem}

/* ====== Grid ====== */
.grid{
  display:grid;
  grid-template-columns: 1.2fr 360px;
  grid-template-areas:
    "main aside"
    "b1   b2";
  gap:16px;
}
.card{background:var(--panel); border:1px solid var(--line); border-radius:var(--radius); padding:14px 16px; box-shadow:var(--shadow)}
.card--lg{grid-area:main; min-height:320px}
.stack{grid-area:aside; display:grid; gap:16px}
.card__header{display:flex; align-items:center; gap:10px; justify-content:space-between; margin-bottom:10px}
.tabs{display:flex; gap:6px; margin-left:auto}
.tab{border:1px solid var(--line); background:var(--panel); border-radius:999px; padding:.35rem .65rem; font-size:.9rem; color:var(--muted); cursor:pointer}
.tab.is-active{background:#ecfeff; border-color:#bae6fd; color:#0369a1}
.toolbar{display:flex; gap:6px}
.btn{border:1px solid var(--line); background:var(--panel); border-radius:8px; padding:.35rem .5rem; cursor:pointer}
.btn--ghost{background:transparent}

.chart{inline-size:100%; block-size:240px; background:repeating-linear-gradient( to bottom, rgba(2,6,23,.04), rgba(2,6,23,.04) 8px, transparent 8px, transparent 16px ); border-radius:12px}

/* Gauges & small widgets */
.row{display:flex; gap:8px; align-items:center}
.row--between{justify-content:space-between}
.small{font-size:.9rem}
.chip--ghost{border:1px dashed var(--line); background:transparent}
.chip--ghost.is-active{border-color:#bae6fd; color:#0369a1}

.gauge{position:relative; inline-size:100%; block-size:140px; display:grid; place-items:center}
.gauge__arc{position:absolute; inset:12px; border-radius:999px; background:conic-gradient(#22c55e 0 45deg, #eab308 45deg 80deg, #ef4444 80deg 120deg, transparent 0)}
.gauge__value{position:relative; font-weight:800; background:var(--panel); padding:.25rem .5rem; border-radius:8px; box-shadow:var(--shadow)}

.battery{display:flex; align-items:center; gap:12px}
.battery__icon{font-size:28px}
.battery__value{font-size:1.4rem; font-weight:800}

/* Bottom cards */
#home-title, #usage-title{font-size:1rem}
.grid > .card:nth-of-type(3){grid-area:b1}
.grid > .card:nth-of-type(4){grid-area:b2}
.usage{display:grid; grid-template-columns: 220px 1fr; gap:12px}
.usage__list{margin:0; padding:0; list-style:none}
.usage__list li{display:flex; align-items:center; justify-content:space-between; padding:.35rem .5rem; border-bottom:1px dashed var(--line)}
.usage__list span{color:var(--muted)}

/* Drawer (PV calculator mount) */
.drawer{
  position:fixed; inset:0 0 0 auto; width:min(560px, 92vw); transform:translateX(110%);
  background:var(--panel); border-left:1px solid var(--line); box-shadow:var(--shadow);
  transition:transform .25s ease; z-index:50; display:flex; flex-direction:column;
}
.drawer[aria-hidden="false"]{transform:translateX(0)}
.drawer__header{display:flex; align-items:center; justify-content:space-between; padding:12px 16px; border-bottom:1px solid var(--line)}
.fab{
  position:fixed; right:22px; bottom:22px; inline-size:56px; block-size:56px; border-radius:999px;
  border:0; background:linear-gradient(135deg,var(--brand),var(--brand-2)); color:white; font-size:24px; box-shadow:var(--shadow); cursor:pointer;
}

/* ====== Responsive ====== */
@media (max-width: 1200px){
  .grid{grid-template-columns: 1fr; grid-template-areas: "main" "aside" "b1" "b2"}
  .stack{grid-auto-flow:row}
  .usage{grid-template-columns:1fr}
}
@media (max-width: 860px){
  .app{grid-template-columns: 72px 1fr}
  .brand__text{display:none}
  .nav__item{justify-content:center}
  .nav__item span:not(.nav__icon){display:none}
}
